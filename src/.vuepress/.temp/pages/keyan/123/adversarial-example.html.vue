<template><div><h1 id="å¯¹æŠ—æ”»å‡»ç»å…¸è®ºæ–‡" tabindex="-1"><a class="header-anchor" href="#å¯¹æŠ—æ”»å‡»ç»å…¸è®ºæ–‡"><span>å¯¹æŠ—æ”»å‡»ç»å…¸è®ºæ–‡</span></a></h1>
<hr>
<h2 id="explaining-and-harnessing-adversarial-examples-fgsm-iclr-2015" tabindex="-1"><a class="header-anchor" href="#explaining-and-harnessing-adversarial-examples-fgsm-iclr-2015"><span><a href="https://arxiv.org/abs/1412.6572" target="_blank" rel="noopener noreferrer">Explaining and harnessing adversarial examples(FGSM) [ <em>ICLR 2015</em> ]</a></span></a></h2>
<p><strong>MOTIVATION:</strong><br>
æœºå™¨å­¦ä¹ æ¨¡å‹å®¹æ˜“å—åˆ°å¯¹æŠ—æ€§æ‰°åŠ¨çš„æ ¹æœ¬åŸå› åœ¨äºç½‘ç»œçš„çº¿æ€§éƒ¨åˆ†(å¯èƒ½è¿˜æºäºæ¨¡å‹å¹³å‡ä¸è¶³æˆ–è€…ç›‘ç£å­¦ä¹ é—®é¢˜æ­£åˆ™åŒ–ä¸è¶³) ã€‚<br>
ä½œè€…è®¤ä¸ºï¼Œåœ¨é«˜ç»´ç©ºé—´ä¸­ï¼Œå³ä½¿æ˜¯å¾®å°çš„çº¿æ€§æ‰°åŠ¨ï¼Œä¹Ÿä¼šåœ¨æœ€ç»ˆè¾“å‡ºä¸Šç´¯ç§¯æˆä¸€ä¸ªå·¨å¤§çš„å˜åŒ–ã€‚</p>
<p>æœ¬æ–‡æ‰¾å‡ºäº†ç½‘ç»œçš„å…±æ€§ï¼šç”±äºè®­ç»ƒèµ„æºçš„ä¸è¶³ï¼Œå› æ­¤å¤§éƒ¨åˆ†ç½‘ç»œéƒ½æ˜¯ä»¥&quot;çº¿æ€§&quot;çš„æ–¹å¼å‘ˆç°(é‚£å½“å‰LLMåŸºäºtransformerçš„å…±æ€§ï¼Ÿ)ã€‚</p>
<figure><img src="/assets/img/2015_ICLR_Explaining_and_harnessing_adversarial_examples_fig1.png" alt=" " tabindex="0" loading="lazy"><figcaption>FGSM</figcaption></figure>
<h3 id="ä»£ç å®ç°" tabindex="-1"><a class="header-anchor" href="#ä»£ç å®ç°"><span>ä»£ç å®ç°ï¼š</span></a></h3>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code" v-pre=""><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> attack</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    perturbed_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    perturbed_label</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    org_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    org_label</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    wrong</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    right</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    success</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> i,(img,label) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> enumerate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()):</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> i</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">==</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.num_size:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            break</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        tensor_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">to_tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        tensor_label</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">to_tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(label)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        tensor_img.stop_gradient </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> False</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        predict </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        pred</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">predict.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">argmax</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">axis</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> pred </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">==</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> tensor_label:</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#å¦‚æœè¢«æ­£ç¡®åˆ†ç±»åˆ™æ‰§è¡Œæ”»å‡»</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            right</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            loss </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">criterion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(predict, tensor_label)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            loss.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">backward</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            grad </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">to_tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_img.grad)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            grad </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">sign</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(grad)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            adv_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> tensor_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.epsilon </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> grad</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">            #æ”»å‡»å®Œæˆä¹‹åå†æ¬¡é¢„æµ‹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            predict </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(adv_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            pred</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">predict.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">argmax</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">axis</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> pred</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">!=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">tensor_label:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                success</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">                #å°†æ”»å‡»åçš„å›¾ç‰‡ä¿å­˜ä¸‹æ¥</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                adv_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">transpose</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(adv_img,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">perm</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                tensor_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">transpose</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_img,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">perm</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                adv_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">np.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">squeeze</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(adv_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                tensor_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">np.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">squeeze</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                adv_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adv_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">*</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">127.5</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">127.5</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                tensor_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">tensor_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">*</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">127.5</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">127.5</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                adv_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adv_img.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">astype</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(np.int64)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                perturbed_img.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(adv_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                tensor_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">tensor_img.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">astype</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(np.int64)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                org_img.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                org_label.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_label.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">())</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                perturbed_label.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(pred.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">())</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            wrong</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            continue</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> right:        </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        succ_rate</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">success</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">right</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> :</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"å…¨éƒ½é¢„æµ‹é”™è¯¯"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(right)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> succ_rate,perturbed_img,org_img,perturbed_label,org_label</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p><strong>è®ºæ–‡ç¬”è®°ï¼š</strong><br>
åŒ…æ‹¬æœ€å…ˆè¿›çš„ç¥ç»ç½‘ç»œåœ¨å†…çš„å‡ ç§æœºå™¨å­¦ä¹ æ¨¡å‹éƒ½å®¹æ˜“å—åˆ°å¯¹æŠ—æ€§æ ·æœ¬çš„æ”»å‡» ã€‚<br>
ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™äº›æœºå™¨å­¦ä¹ æ¨¡å‹ä¼šå°†ä¸æ­£ç¡®åˆ†ç±»æ ·æœ¬åªæœ‰å¾®å°å·®å¼‚çš„è¾“å…¥é”™è¯¯åˆ†ç±» ã€‚<br>
åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œå„ç§å…·æœ‰ä¸åŒæ¶æ„æˆ–åœ¨ä¸åŒè®­ç»ƒæ•°æ®å­é›†ä¸Šè®­ç»ƒçš„å¤šä¸ªæ¨¡å‹ï¼Œéƒ½ä¼šå¯¹åŒä¸€ä¸ªå¯¹æŠ—æ€§æ ·æœ¬è¿›è¡Œé”™è¯¯åˆ†ç±»ã€‚<br>
ï¼ˆè¿™äº›ç½‘ç»œçš„å…±åŒç‚¹æ˜¯åœ¨äºéƒ½å…·æœ‰åºå¤§çš„çº¿æ€§ç»“æ„ï¼‰</p>
</blockquote>
<hr>
<h2 id="adversarial-machine-learning-at-scale-bim-iclr-2017" tabindex="-1"><a class="header-anchor" href="#adversarial-machine-learning-at-scale-bim-iclr-2017"><span><a href="https://arxiv.org/abs/1611.01236" target="_blank" rel="noopener noreferrer">ADVERSARIAL MACHINE LEARNING AT SCALE (BIM) [ <em>ICLR 2017</em> ]</a></span></a></h2>
<p><strong>MOTIVATION:</strong><br>
ä»¥å¾€çš„ç ”ç©¶ä¸»è¦å°†å¯¹æŠ—è®­ç»ƒåº”ç”¨äºåƒ MNIST å’Œ CIFAR10 è¿™æ ·ç›¸å¯¹è¾ƒå°çš„æ•°æ®é›†ä¸Šï¼Œ<br>
è€Œæœ¬æ–‡åˆ™å°†å¯¹æŠ—è®­ç»ƒåº”ç”¨äº ImageNetï¼Œå¹¶å¯¹Inceptionæ¨¡å‹è¿›è¡Œäº†ç ”ç©¶ã€‚<br>
å¹¶ä¸”æ¨¡å‹1é”™è¯¯åˆ†ç±»çš„å¯¹æŠ—æ ·æœ¬ï¼Œå¾€å¾€ä¹Ÿä¼šè¢«æ¨¡å‹2é”™è¯¯åˆ†ç±»ï¼Œè¯´æ˜å¯¹æŠ—æ ·æœ¬çš„ <strong>å¯è¿ç§»æ€§</strong><br>
æ„å‘³ç€åœ¨ä¸çŸ¥é“ç›®æ ‡æ¨¡å‹å‚æ•°çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç”Ÿæˆå¯¹æŠ—æ ·æœ¬å¹¶å¯¹æœºå™¨å­¦ä¹ ç³»ç»Ÿå‘èµ·è¯¯åˆ†ç±»æ”»å‡»ã€‚</p>
<figure><img src="/assets/img/2017_ICLR_ADVERSARIAL_MACHINE_LEARNING_AT_SCALE.png" alt=" " tabindex="0" loading="lazy"><figcaption>BIM Algorithm</figcaption></figure>
<h3 id="è¿­ä»£æœ€ä¸å¯èƒ½ç±»åˆ«-ä¼ªä»£ç " tabindex="-1"><a class="header-anchor" href="#è¿­ä»£æœ€ä¸å¯èƒ½ç±»åˆ«-ä¼ªä»£ç "><span>è¿­ä»£æœ€ä¸å¯èƒ½ç±»åˆ« ä¼ªä»£ç ï¼š</span></a></h3>
<p>ç›®æ ‡æ¯ä¸€æ­¥éƒ½æœä½¿æ¨¡å‹å°†è¾“å…¥åˆ†ç±»ä¸ºå½“å‰æœ€ä¸å¯èƒ½ç±»åˆ«çš„æ–¹å‘ç§»åŠ¨</p>
<p>è¾“å…¥ï¼šå¹²å‡€å›¾åƒ Xï¼Œæ‰°åŠ¨ä¸Šé™ Îµï¼Œæ­¥é•¿ Î±ï¼ˆä¾‹å¦‚1ï¼‰ï¼Œè¿­ä»£æ¬¡æ•° Tï¼ˆå¯ç”¨ä¸Šé¢ç»éªŒå…¬å¼ï¼‰<br>
è¾“å‡ºï¼šå¯¹æŠ—å›¾åƒ X_adv</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code" v-pre=""><code class="language-"><span class="line"><span>1. è®¡ç®— y_LL = argmin_y p(y | X)   # æœ€ä¸å¯èƒ½ç±»åˆ«ï¼ˆåŸºäºåŸå§‹ X çš„é¢„æµ‹ï¼‰</span></span>
<span class="line"><span>2. X_adv = X</span></span>
<span class="line"><span>3.  for t in 1..T:</span></span>
<span class="line"><span>4.     g = âˆ‡_X J(X_adv, y_LL)      # å¯¹å½“å‰è¾“å…¥å…³äºç›®æ ‡ç±»çš„æŸå¤±æ±‚æ¢¯åº¦</span></span>
<span class="line"><span>5.     X_adv = X_adv - Î± * sign(g) # æœä½¿æ¦‚ç‡å˜å¤§çš„æ–¹å‘å°æ­¥ç§»åŠ¨</span></span>
<span class="line"><span>6.     X_adv = Clip_{X, Îµ}(X_adv)  # ä¿è¯ä¸è¶…å‡º Lâˆ é™åˆ¶å¹¶ä¿æŒåƒç´ åˆæ³•</span></span>
<span class="line"><span>7. end</span></span>
<span class="line"><span>8. è¿”å› X_adv</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä»£ç å®ç°-1" tabindex="-1"><a class="header-anchor" href="#ä»£ç å®ç°-1"><span>ä»£ç å®ç°</span></a></h3>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code" v-pre=""><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> pred</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">==</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> tensor_label:</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#å¦‚æœè¢«æ­£ç¡®åˆ†ç±»åˆ™æ‰§è¡Œæ”»å‡»</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        right</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # Add code</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        for</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> iter</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> range</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.num_iters):</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># å¤šæ¬¡è¿­ä»£</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            adv_img.stop_gradient </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> False</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            predict</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(adv_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            loss </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">criterion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(predict, tensor_label)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> parameter </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">in</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.model.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">parameters</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">():</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                parameter.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">clear_grad</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            loss.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">backward</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">retain_graph</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">True</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            grad </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">to_tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(adv_img.grad)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            delta </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.alpha </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">sign</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(grad)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            tmp_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> adv_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> delta</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            tensor_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">to_tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            clip_delta </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">clip</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tmp_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">tensor_img, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">min</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.epsilon, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">max</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.epsilon)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            adv_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adv_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">clip_delta</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">            #æ”»å‡»å®Œæˆä¹‹åå†æ¬¡é¢„æµ‹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            predict </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(adv_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            pred</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">predict.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">argmax</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">axis</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> pred</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">!=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">tensor_label:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                success</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">                #å°†æ”»å‡»åçš„å›¾ç‰‡ä¿å­˜ä¸‹æ¥</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                adv_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">transpose</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(adv_img,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">perm</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                tensor_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">transpose</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_img,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">perm</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                adv_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">np.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">squeeze</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(adv_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                tensor_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">np.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">squeeze</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                adv_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adv_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">*</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">127.5</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">127.5</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                tensor_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">tensor_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">*</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">127.5</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">127.5</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                adv_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adv_img.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">astype</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(np.int64)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                perturbed_img.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(adv_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                tensor_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">tensor_img.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">astype</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(np.int64)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                org_img.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                org_label.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_label.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">())</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                perturbed_label.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(pred.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">())</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                break</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># æˆåŠŸçš„é€€å‡ºè¿­ä»£</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        #end addcode</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p><strong>è®ºæ–‡ç¬”è®°ï¼š</strong><br>
åŒæœŸç ”ç©¶ä¾§é‡åœ¨ ImageNet ä¸Šç ”ç©¶æ”»å‡»æœºåˆ¶ï¼Œé‡ç‚¹å…³æ³¨å¯¹æŠ—æ ·æœ¬åœ¨ä¸åŒç±»å‹æ¨¡å‹ä¹‹é—´è¿ç§»æ•ˆæœå¦‚ä½•ï¼Œ<br>
è€Œæœ¬æ–‡åˆ™ä¾§é‡äºé˜²å¾¡ï¼Œå¹¶ç ”ç©¶ä¸åŒç±»å‹çš„å¯¹æŠ—æ ·æœ¬ç”Ÿæˆç¨‹åºåœ¨ç›¸å¯¹ç›¸ä¼¼çš„æ¨¡å‹ä¹‹é—´è¿ç§»æ•ˆæœå¦‚ä½• ã€‚</p>
</blockquote>
<blockquote>
<p><strong>å®éªŒæ€»ç»“ï¼š</strong></p>
<ul>
<li>
<p>æ”»å‡»æ€§å¼ºçš„æ ·æœ¬å¾€å¾€æ›´ä¾èµ–äºæºæ¨¡å‹ï¼Œä¸æ˜“è¿ç§»ï¼› å³ <strong>å¯¹æŠ—æ ·æœ¬åŒæ ·å­˜åœ¨&quot; æ³›åŒ–æ€§ &quot;</strong></p>
</li>
<li>
<p>è¾ƒå¤§å®¹é‡çš„æ¨¡å‹ åœ¨å¯¹æŠ—æ ·æœ¬ä¸Šçš„é²æ£’æ€§æ›´å¼ºï¼›</p>
</li>
<li>
<p>æ ‡ç­¾æ³„éœ²ï¼šä½¿ç”¨çœŸå®æ ‡ç­¾çš„å•æ­¥ç”Ÿæˆæ–¹æ³•ï¼ˆå¦‚FGSMï¼‰ä¼šäº§ç”Ÿä¸€ç§ç®€å•ä¸”å¯é¢„æµ‹çš„è½¬æ¢æ¨¡å¼ï¼Œæ¨¡å‹å¯ä»¥å­¦ä¼šè¯†åˆ«è¿™ç§æ¨¡å¼ã€‚</p>
</li>
</ul>
<p>å› æ­¤ï¼Œå¯¹æŠ—æ€§æ ·æœ¬çš„æ„å»ºè¿‡ç¨‹æ— æ„ä¸­å°†çœŸå®æ ‡ç­¾çš„ä¿¡æ¯æ³„éœ²åˆ°äº†è¾“å…¥ä¸­ã€‚</p>
</blockquote>
<hr>
<h1 id="towards-deep-learning-models-resistant-to-adversarial-attacks-iclr-2018" tabindex="-1"><a class="header-anchor" href="#towards-deep-learning-models-resistant-to-adversarial-attacks-iclr-2018"><span><a href="https://arxiv.org/abs/1706.06083" target="_blank" rel="noopener noreferrer">Towards Deep Learning Models Resistant to Adversarial Attacks [ ICLR 2018 ]</a></span></a></h1>
<p><strong>MOTIVATION:</strong><br>
ç›®å‰çš„å„ç§æ”»å‡»é˜²å¾¡æœºåˆ¶ï¼ˆé˜²å¾¡è’¸é¦ã€ç‰¹å¾å‹ç¼©ã€å¯¹æŠ—æ€§æ ·æœ¬æ£€æµ‹ï¼‰çš„å®‰å…¨ä¿è¯ä¸å¤Ÿæ¸…æ™°ï¼Œç ”ç©¶è€…æ— æ³•ç¡®å®šæ”»å‡»æ˜¯å¦æ‰¾åˆ°äº†&quot;æœ€å…·å¯¹æŠ—æ€§&quot;çš„æ ·æœ¬ï¼Œ<br>
ä¹Ÿæ— æ³•ç¡®å®šæŸä¸ªé˜²å¾¡æœºåˆ¶æ˜¯å¦çœŸæ­£åœ°é˜»æ­¢æŸç±»å¯¹æŠ—æ”»å‡»çš„å­˜åœ¨ã€‚å› æ­¤ï¼Œæœ¬æ–‡å°è¯•é€šè¿‡é²æ£’ä¼˜åŒ–çš„è§†è§’æ¥ç ”ç©¶ç¥ç»ç½‘ç»œçš„å¯¹æŠ—é²æ£’æ€§ã€‚<br>
ä½œè€…æå‡ºä¸€ç§ <strong>éç‚¹é—®é¢˜ï¼ˆmin-max formulationï¼‰</strong> æ¥åˆ»ç”»å¯¹æŠ—æ”»å‡»ä¸‹çš„å®‰å…¨æ€§ã€‚<br>
è¿™ç§å½¢å¼åŒ–æ–¹æ³•èƒ½å¸®åŠ©æˆ‘ä»¬æ˜ç¡®éœ€è¦å®ç°çš„å®‰å…¨ä¿è¯ï¼Œå³è¦æŠµå¾¡å“ªä¸€ç±»æ”»å‡»ï¼Œè€Œä¸ä»…ä»…æ˜¯é˜²å¾¡æŸäº›å·²çŸ¥çš„ç‰¹å®šæ”»å‡»ã€‚<br>
åŒæ—¶ï¼Œå®ƒä¹Ÿèƒ½æŠŠæ”»å‡»ä¸é˜²å¾¡ç»Ÿä¸€åœ¨åŒä¸€ä¸ªç†è®ºæ¡†æ¶ä¸‹ã€‚</p>
<p><img src="/assets/img/2018_ICLR_Towards_Deep_Learning_Models_Resistant_to_Adversarial_Attacks.png" alt=" " title="PGD" loading="lazy"><br>
å¯¹æŠ—é²æ£’æ€§è¦æ±‚åˆ†ç±»å™¨ä¸ä»…èƒ½æ­£ç¡®åˆ†å¼€æ•°æ®ç‚¹ï¼Œè¿˜è¦èƒ½æ­£ç¡®è¦†ç›–æ¯ä¸ªç‚¹å‘¨å›´çš„æ‰°åŠ¨ç©ºé—´ï¼ˆå¯¹æŠ—æ€§æ ·æœ¬ï¼‰ï¼Œå› æ­¤éœ€è¦æ›´å¤æ‚çš„å†³ç­–è¾¹ç•Œä»¥åŠæ›´å¤§å®¹é‡çš„æ¨¡å‹ã€‚</p>
<p><strong>éç‚¹é—®é¢˜ï¼š</strong><br>
$\min_{\theta} \rho(\theta), \ \text{å…¶ä¸­ } \rho(\theta) = \mathbb{E}<em>{(x,y)\sim D}!\left[ \max</em>{\delta \in S} L(\theta, x+\delta, y) \right]$</p>
<p>æ”»å‡»ï¼ˆå†…å±‚æœ€å¤§åŒ–ï¼‰ï¼šç»™å®šä¸€ä¸ªæ ·æœ¬ï¼Œæ”»å‡»è€…å¸Œæœ›åœ¨å…è®¸çš„æ‰°åŠ¨èŒƒå›´å†…ï¼Œæ‰¾åˆ°èƒ½è®©æ¨¡å‹æŸå¤±å°½å¯èƒ½å¤§çš„æ‰°åŠ¨ã€‚</p>
<p>é˜²å¾¡ï¼ˆå¤–å±‚æœ€å°åŒ–ï¼‰ï¼šå¤–å±‚æœ€å°åŒ–çš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ç»„æ¨¡å‹å‚æ•° ğœƒï¼Œä½¿å¾—å³ä¾¿é¢å¯¹æœ€åæƒ…å†µçš„æ‰°åŠ¨ï¼Œæ•´ä½“çš„æœŸæœ›æŸå¤±ä»ç„¶æœ€å°åŒ–ã€‚<br>
è¿™æ„å‘³ç€æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ä¸ä»…è¦åœ¨è‡ªç„¶æ ·æœ¬ä¸Šè¡¨ç°è‰¯å¥½ï¼Œè¿˜å¿…é¡»è€ƒè™‘åˆ°æ”»å‡»è€…å¯èƒ½æ–½åŠ çš„æ‰€æœ‰æ½œåœ¨æ‰°åŠ¨ã€‚</p>
<p><strong>è§£å†³ï¼š</strong> å¦‚ä½•ç”Ÿæˆå¼ºæœ‰åŠ›çš„å¯¹æŠ—æ ·æœ¬ï¼Œå³åœ¨ä¿æŒå¾®å°æ‰°åŠ¨çš„åŒæ—¶ï¼Œä»¥é«˜ç½®ä¿¡åº¦æ¬ºéª—æ¨¡å‹ï¼Ÿ<br>
ä»¥åŠ å¦‚ä½•è®­ç»ƒå‡ºä¸€ç§æ¨¡å‹ï¼Œä½¿å¾—å¯¹æŠ—æ ·æœ¬ä¸å­˜åœ¨ï¼Œæˆ–è€…è‡³å°‘è®©æ”»å‡»è€…éš¾ä»¥æ‰¾åˆ°å®ƒä»¬ï¼Ÿ</p>
<p><strong>PGDçš„æ€æƒ³æ˜¯ï¼š</strong> ä»ä¸€ä¸ªéšæœºåˆå§‹åŒ–çš„ç‚¹å¼€å§‹ï¼Œæ²¿ç€æŸå¤±å‡½æ•°çš„æ¢¯åº¦æ–¹å‘åå¤è¿­ä»£æ›´æ–°æ‰°åŠ¨ï¼Œå¹¶åœ¨æ¯ä¸€æ­¥æŠŠç»“æœæŠ•å½±å›å…è®¸çš„æ‰°åŠ¨é›†åˆ ğ‘† ä¸­ã€‚<br>
ä½œè€…å‘ç°ï¼ŒPGDèƒ½å¤ŸæŒç»­æå‡æŸå¤±ï¼Œä¸”ç›¸æ¯”äºå•æ­¥æ–¹æ³•ï¼ˆå¦‚ FGSMï¼‰èƒ½å¤Ÿæ‰¾åˆ°æ›´å¼ºçš„å¯¹æŠ—æ ·æœ¬ã€‚<br>
æ›´é‡è¦çš„æ˜¯ï¼Œæœ¬æ–‡çš„å®éªŒè¯æ˜ï¼ŒPGD åœ¨å¤šæ¬¡éšæœºé‡å¯åï¼Œå‡ ä¹æ€»èƒ½æ”¶æ•›åˆ°ç›¸ä¼¼çš„é«˜æŸå¤±ç‚¹ã€‚<br>
è¿™è¡¨æ˜ï¼ŒPGDæ”»å‡»æ˜¯å¯¹å†…å±‚æœ€å¤§åŒ–çš„ä¸€ä¸ªè¿‘ä¼¼æœ€ä¼˜è§£ï¼Œå› æ­¤å¯ä»¥è¢«è§†ä½œä¸€ç§â€œé€šç”¨çš„ä¸€é˜¶æ”»å‡»è€…â€ã€‚</p>
<h3 id="ä»£ç å®ç°-2" tabindex="-1"><a class="header-anchor" href="#ä»£ç å®ç°-2"><span>ä»£ç å®ç°</span></a></h3>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code" v-pre=""><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> pred</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">==</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> tensor_label:</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#å¦‚æœè¢«æ­£ç¡®åˆ†ç±»åˆ™æ‰§è¡Œæ”»å‡»</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    right</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    delta_init </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">uniform</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(img.shape, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">dtype</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'float32'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">min</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.epsilon, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">max</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.epsilon)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    clip_delta </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">clip</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(delta_init, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.epsilon, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.epsilon)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    tensor_img_iter </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> tensor_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">clip_delta</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    for</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> iter</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> range</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.num_iters):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        tensor_img_iter.stop_gradient</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">False</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        predict</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_img_iter)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        loss </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">criterion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(predict, tensor_label)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> param </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">in</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.model.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">parameters</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">():</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            param.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">clear_grad</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        loss.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">backward</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">retain_graph</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">True</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        grad </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">to_tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_img_iter.grad)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        delta </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.alpha </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">sign</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(grad)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        tensor_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">to_tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        tmp_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> tensor_img_iter</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">delta</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        clip_delta </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">clip</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tmp_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">tensor_img, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">min</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.epsilon, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">max</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.epsilon)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        adv_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> tensor_img_iter</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">clip_delta</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        #æ”»å‡»å®Œæˆä¹‹åå†æ¬¡é¢„æµ‹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        predict </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(adv_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        pred </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> predict.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">argmax</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">axis</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> pred </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">!=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> tensor_label:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            success </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">            #å°†æ”»å‡»åçš„å›¾ç‰‡ä¿å­˜ä¸‹æ¥</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            adv_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">transpose</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(adv_img,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">perm</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">            # tensor_img = paddle.to_tensor(img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            tensor_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> paddle.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">transpose</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_img,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">perm</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            adv_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> np.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">squeeze</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(adv_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            tensor_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> np.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">squeeze</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            adv_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> adv_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">*</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">127.5</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">127.5</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            tensor_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> tensor_img</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">*</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">127.5</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">127.5</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            adv_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> adv_img.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">astype</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(np.int64)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            perturbed_img.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(adv_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            tensor_img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> tensor_img.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">astype</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(np.int64)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            org_img.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            org_label.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(tensor_label.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">())</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            perturbed_label.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(pred.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">())</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            break</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        tensor_img_iter </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> adv_img</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p><strong>è®ºæ–‡ç¬”è®°ï¼š</strong> æœ¬æ–‡å·¥ä½œç›¸è¾ƒäºBIMçš„æ–¹æ³•ä»…åœ¨å¯¹æŠ—æ ·æœ¬ä¸Šå¤šäº†éšæœºå™ªå£°ä»¥åŠè¿­ä»£è½®æ•°å¢åŠ </p>
</blockquote>
<hr>
<h1 id="towards-evaluating-the-robustness-of-neural-networks-ieee-2017" tabindex="-1"><a class="header-anchor" href="#towards-evaluating-the-robustness-of-neural-networks-ieee-2017"><span><a href="https://ieeexplore.ieee.org/abstract/document/7958570" target="_blank" rel="noopener noreferrer">Towards evaluating the robustness of neural networks [ IEEE 2017 ]</a></span></a></h1>
<p><strong>MOTIVATIONï¼š</strong> æœ¬æ–‡æ˜¯é’ˆå¯¹ é˜²å¾¡æ€§è’¸é¦ï¼ˆDefensive Distillationï¼‰ç½‘ç»œ æ‰€æå‡ºçš„ã€‚<br>
ä½œè€…è®¤ä¸ºè¯„ä¼°ç¥ç»ç½‘ç»œé²æ£’æ€§çš„æ–¹æ³•æœ‰ä¸¤ç±»ï¼šä¸€ç§æ˜¯å°è¯•è¯æ˜é²æ£’æ€§çš„ä¸‹ç•Œï¼Œå¦ä¸€ç§æ˜¯æ„é€ æ”»å‡»æ¥å±•ç¤ºé²æ£’æ€§çš„ä¸Šç•Œã€‚<br>
å‰è€…è™½ç„¶ç†è®ºä¸Šä¸¥è°¨ï¼Œä½†åœ¨å®è·µä¸­å®ç°å›°éš¾ï¼Œä¸”é€šå¸¸éœ€è¦è¿‘ä¼¼ ã€‚è€Œåè€…å¦‚æœæ”»å‡»æ–¹æ³•ä¸å¤Ÿå¼ºå¤§ï¼Œé¢‘ç¹å¤±è´¥ï¼Œé‚£ä¹ˆç»™å‡ºçš„ä¸Šç•Œä¹Ÿå°±æ²¡æœ‰å‚è€ƒä»·å€¼ã€‚<br>
å› æ­¤ï¼Œåœ¨æœ¬æ–‡æå‡ºäº†ä¸€ç»„æ–°çš„æ”»å‡»æ–¹æ³•ï¼Œå¯ç”¨äºæ„å»ºç¥ç»ç½‘ç»œé²æ£’æ€§çš„ä¸Šç•Œã€‚<br>
ä½œä¸ºæ¡ˆä¾‹ç ”ç©¶ï¼Œæˆ‘ä»¬åˆ©ç”¨è¿™äº›æ”»å‡»è¯æ˜é˜²å¾¡æ€§è’¸é¦å¹¶ä¸èƒ½çœŸæ­£æ¶ˆé™¤å¯¹æŠ—æ ·æœ¬ã€‚</p>
<blockquote>
<p><strong>NOTEï¼š</strong> æœ¬æ–‡æ•°å­¦ç¬¦å·è¯´æ˜è¯¦ç»†ï¼Œå¹¶ä¸”å¯¹æ­¤å‰çš„ç»å…¸å¯¹æŠ—æ”»å‡»æ–¹æ³•åšäº†ç®€è¦æ€»ç»“ <strong>[ å»ºè®®ç²¾è¯» ]</strong></p>
</blockquote>
<h3 id="æœ¬æ–‡çš„-l-2-æ”»å‡»" tabindex="-1"><a class="header-anchor" href="#æœ¬æ–‡çš„-l-2-æ”»å‡»"><span>æœ¬æ–‡çš„$L_2$æ”»å‡»ï¼š</span></a></h3>
<p><strong>åŸå§‹ç›®æ ‡ï¼š</strong> æƒ³åœ¨ä¸æ”¹å˜å›¾åƒå¤ªå¤šçš„å‰æä¸‹ï¼ŒæŠŠä¸€å¼ å›¾åƒ ğ‘¥ æ”¹æˆè¢«åˆ†ç±»å™¨åˆ¤ä¸ºæŸä¸ªæŒ‡å®šç›®æ ‡ç±» ğ‘¡ ã€‚æ•°å­¦ä¸Šå¯å†™ä½œå¸¦çº¦æŸçš„é—®é¢˜ï¼š</p>
<p>$$<br>
\min_{x'} ; |x' - x|_2<br>
$$<br>
$$<br>
\quad \text{s.t } C(x') = t,;; x' \in [0,1]^n.<br>
$$</p>
<p>ä¹Ÿå°±æ˜¯è¯´â€”â€”åœ¨æ‰€æœ‰ä¼šè¢«åˆ¤ä¸º ğ‘¡ çš„å›¾åƒä¸­ï¼Œæ‰¾ä¸€ä¸ªä¸åŸå›¾ ğ‘¥ æœ€æ¥è¿‘çš„ï¼ˆ$L_2$ æœ€å°ï¼‰</p>
<p><strong>ä¸ºä»€ä¹ˆæŠŠçº¦æŸå˜æˆæ— çº¦æŸï¼ˆç”¨åŠ ç½šé¡¹ï¼‰â€”â€”Lagrange/ç½šå‡½æ•°æ€æƒ³ï¼š</strong> ç›´æ¥å¸¦ç€ç¦»æ•£ï¼ˆåˆ†ç±»ï¼‰çº¦æŸå»ä¼˜åŒ–å¾ˆéš¾ã€‚<br>
å¸¸ç”¨çš„å¤„ç†æ–¹å¼æ˜¯æŠŠçº¦æŸç”¨æƒ©ç½šé¡¹å†™åˆ°ç›®æ ‡é‡Œï¼Œå˜æˆæ— çº¦æŸä¼˜åŒ–ï¼š</p>
<p>$$<br>
\min_{x'} ; |x' - x|_2^2 + c \cdot f(x') \quad \text{ä¸” } x' \in [0,1]^n<br>
$$</p>
<p>å…¶ä¸­ $f(x')$ æ˜¯ä¸ªæ ‡é‡åŒ–çš„â€œè¿è§„åº¦â€â€”â€”å½“ä¸”ä»…å½“ $C(x')=t$ æ—¶è¡¨ç¤º ï¼ˆæˆ–æ»¡è¶³æŸä¸ªåˆ¤åˆ« marginï¼‰ã€‚<br>
å‚æ•° $c&gt;0$ æ§åˆ¶â€œè·ç¦»â€ä¸â€œè¾¾æˆç›®æ ‡ç±»åˆ«â€è¿™ä¸¤é¡¹çš„æƒè¡¡ï¼ˆç±»ä¼¼æ‹‰æ ¼æœ—æ—¥ä¹˜å­ï¼‰ã€‚<br>
é€šè¿‡å¯¹ $c$ æœç´¢ï¼ˆä¾‹å¦‚äºŒåˆ†ï¼‰å¯ä»¥æ‰¾åˆ°æœ€å°æ‰°åŠ¨çš„è§£ã€‚</p>
<p><strong>å˜é‡æ›¿æ¢ï¼š</strong> ä¸ºä¿è¯åƒç´ å€¼å§‹ç»ˆåœ¨ $[0,1]$ (é’ˆå¯¹ç›’çº¦æŸï¼Œä¸éœ€è¦æ¯æ­¥clip), æ–‡ç« å¼•å…¥æ–°å˜é‡ $w \in \mathbb{R}^n$ å®šä¹‰å…‰æ»‘æ˜ å°„ï¼š</p>
<p>$$<br>
x'(w) = \tfrac{1}{2}\big(\tanh(w) + 1\big)<br>
$$</p>
<p>æ­¤æ—¶ï¼Œæ— è®º $w$ å–ä½•å€¼ï¼Œ $x'(w)$ éƒ½è‡ªåŠ¨è½åœ¨$[0,1]$ ä¹‹é—´ï¼Œåˆ™åŸé—®é¢˜å˜ä¸º$w$ ç©ºé—´çš„æ— çº¦æŸä¼˜åŒ–é—®é¢˜(æ–¹ä¾¿ä½¿ç”¨Adamn/L-BFGS ç­‰ä¼˜åŒ–å™¨)ï¼Œ<br>
è¿™ä¹Ÿæ˜¯å…¬å¼ä¸­å‡ºç° $\tfrac{1}{2}\big(\tanh(w) + 1\big)$ çš„åŸå› ï¼ŒåŒæ—¶$L_2$è·ç¦»å…³äº $w$ çš„å½¢å¼ä¸ºï¼š</p>
<p>$$<br>
|\tfrac{1}{2}\big(tanh(w)+1\big)-x|_2^2<br>
$$</p>
<p><strong>ç›®æ ‡å‡½æ•°ï¼š</strong></p>
<p>$$<br>
f(x') = \max!\left( \max_{i \ne t} Z(x')_i - Z(x')_t,; -\kappa \right)<br>
$$</p>
<p>$Z(x')$ è¡¨ç¤ºç½‘ç»œåœ¨ softmax å‰çš„ logitsï¼ˆæœªå½’ä¸€åŒ–çš„å¾—åˆ†ï¼‰ã€‚</p>
<p>$\max_{i \ne t} Z_i - Z_t$ æ˜¯â€œéç›®æ ‡ç±»çš„æœ€é«˜ logit ä¸ç›®æ ‡ç±» logit çš„å·®å€¼â€ã€‚</p>
<ul>
<li>è‹¥è¿™ä¸ªå·®å€¼ $&lt; 0$ï¼Œè¯´æ˜ $Z_t$ å·²ç»å¤§äºæ‰€æœ‰å…¶å®ƒç±»ï¼ˆå³ç½‘ç»œæŠŠ $x'$ é¢„æµ‹ä¸º $t$ï¼‰ï¼›æ•°å€¼è¶Šå°è¯´æ˜ margin è¶Šå¤§ã€‚</li>
</ul>
<p>é€šè¿‡å– $\max(\cdot, -\kappa)$ å¼•å…¥ <strong>ç½®ä¿¡åº¦å‚æ•°</strong> $\kappa$ï¼š</p>
<ul>
<li>éœ€è¦ $f(x') \leq 0$ æ‰ç®—æ»¡è¶³çº¦æŸ $;\Rightarrow; \max_{i \ne t} Z_i - Z_t \leq -\kappa ;\Rightarrow; Z_t \geq \max_{i \ne t} Z_i + \kappa$ã€‚</li>
<li>æ¢å¥è¯è¯´ï¼Œæ˜¯å¸Œæœ›ç›®æ ‡ç±»é¢†å…ˆå…¶å®ƒç±»çš„ <strong>æœ€å° margin</strong>ã€‚
<ul>
<li>$\kappa = 0$ è¦æ±‚åªè¦ $Z_t$ æœ€å¤§å°±è¡Œï¼›</li>
<li>$\kappa &gt; 0$ è¦æ±‚æœ‰ä¸€å®šç½®ä¿¡åº¦ï¼ˆæ›´ç¨³å¥ã€å¯è¿ç§»æ€§æ›´å¼ºï¼‰ã€‚</li>
</ul>
</li>
</ul>
<p><strong>æœ€ç»ˆä¼˜åŒ–é—®é¢˜å†™ä¸ºï¼š</strong><br>
$$<br>
\min_{w} ;<br>
\underbrace{\left| \tfrac{1}{2}(\tanh(w) + 1) - x \right|<em>2^2}</em>{\text{(A) L2 è·ç¦»é¡¹ï¼Œå°½é‡å°çš„æ‰°åŠ¨}}<br>
;+;<br>
\underbrace{c \cdot f!\left(\tfrac{1}{2}(\tanh(w) + 1)\right)}_{\text{(B) åˆ†ç±»æƒ©ç½šï¼Œç¡®ä¿è¢«åˆ¤ä¸ºç›®æ ‡ç±» (å¸¦ margin)}}<br>
$$</p>
<ul>
<li>
<p><strong>(A)</strong> æƒ©ç½šæ‰°åŠ¨å¤§å°ï¼ˆç›®æ ‡æ˜¯å°½å¯èƒ½å°çš„ L2 æ‰°åŠ¨ï¼‰ã€‚</p>
</li>
<li>
<p><strong>(B)</strong> è‹¥ $x'(w)$ è¿˜æ²¡æœ‰è¢«åˆ¤ä¸ºç›®æ ‡ç±» $t$ï¼ˆæˆ–æ²¡æœ‰è¾¾åˆ° margin $\kappa$ï¼‰ï¼Œåˆ™ $f &gt; 0$ å¸¦æ¥æƒ©ç½šï¼Œ<br>
å¼•å¯¼ä¼˜åŒ–å‘ä½¿ $f \leq 0$ çš„æ–¹å‘å‰è¿›ã€‚</p>
<p>ç³»æ•° $c$ æƒè¡¡ä¸¤è€…ï¼š</p>
<ul>
<li>è¶Šå¤§è¶Šå¼ºè°ƒæˆåŠŸåˆ†ç±»ï¼›</li>
<li>è¶Šå°è¶Šå¼ºè°ƒå‡å°‘æ‰°åŠ¨ã€‚</li>
</ul>
</li>
</ul>
<p><strong>ç»¼ä¸Šï¼š</strong> è¿™æ¡å…¬å¼æ˜¯æŠŠ &quot;å¯»æ‰¾æœ€å° L2 æ‰°åŠ¨ä½¿å›¾åƒè¢«åˆ†ç±»æˆç›®æ ‡ç±»&quot; è¿™<br>
å¸¦çº¦æŸä¼˜åŒ–å¸¦çº¦æŸä¼˜åŒ–é—®é¢˜ï¼Œç”¨å˜é‡æ›¿æ¢ $ï¼ˆtanhï¼‰$ + ç½šå‡½æ•° $ï¼ˆcÂ·fï¼‰$ çš„æ–¹å¼ï¼Œ<br>
è½¬æˆåœ¨$w$ç©ºé—´ä¸Šå¯è¢«ç°ä»£æ— çº¦æŸä¼˜åŒ–å™¨é«˜æ•ˆæ±‚è§£çš„å¹³æ»‘å¯å¾®ä¼˜åŒ–é—®é¢˜ã€‚å…¶ä¸­ï¼š</p>
<ul>
<li>$tanh$ ä¿è¯åƒç´ åœ¨åˆæ³•åŒºé—´ï¼›</li>
<li>$L_2$é¡¹çº¦æŸæ‰°åŠ¨å¤§å°ï¼›</li>
<li>$f$ï¼ˆåŸºäº logitsï¼‰çš„è®¾è®¡ä¿è¯ç›®æ ‡ç±»èƒœå‡ºå¹¶å¯å¸¦ marginï¼›</li>
<li>$c$ å’Œ $\kappa$ æä¾›æˆåŠŸç‡ä¸æ‰°åŠ¨å¤§å°ã€ç½®ä¿¡åº¦ä¹‹é—´çš„å¯æ§æƒè¡¡ã€‚</li>
</ul>
<hr>
<h1 id="distillation-as-a-defense-to-adversarial-perturbations-against-deep-neural-ieee-2016" tabindex="-1"><a class="header-anchor" href="#distillation-as-a-defense-to-adversarial-perturbations-against-deep-neural-ieee-2016"><span><a href="https://ieeexplore.ieee.org/abstract/document/7546524" target="_blank" rel="noopener noreferrer">Distillation as a defense to adversarial perturbations against deep neural [ IEEE 2016 ]</a></span></a></h1>
<p><strong>MOTIVATIONï¼š</strong> æ­¤å‰å¤§å¤šæ•°å·¥ä½œéƒ½æ˜¯ä»æ­£åˆ™åŒ–æ–¹æ³•æˆ–æ•°æ®å¢å¼ºè§’åº¦é˜²å¾¡å¯¹æŠ—æ”»å‡»ã€‚<br>
æœ¬æ–‡åˆ†æäº†å°†è’¸é¦ç”¨ä½œå¯¹æŠ—æ ·æœ¬çš„é˜²å¾¡æœºåˆ¶ï¼ˆ&quot;æ¦‚ç‡å‘é‡&quot;çš„è•´å«çš„ä¸°å¯Œä¿¡æ¯ï¼‰ï¼Œ<br>
åˆ©ç”¨è’¸é¦è¿‡ç¨‹ä¸­æå–çš„â€œçŸ¥è¯†â€æ¥é™ä½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥ç”Ÿæˆå¯¹æŠ—æ ·æœ¬çš„ç½‘ç»œæ¢¯åº¦å¹…åº¦ã€‚</p>
<blockquote>
<p><strong>è®ºæ–‡ç¬”è®°ï¼š</strong> å¤šä»æ³›åŒ–æ€§çš„è§’åº¦è€ƒè™‘é˜²å¾¡å¯¹æŠ—æ”»å‡»ï¼Œ<br>
ç»è¿‡ teacher æ¨¡å‹ softmax å±‚é«˜æ¸©è’¸é¦è¿‡çš„&quot;æ¦‚ç‡å‘é‡&quot;æœ¬æ˜¯è®¾è®¡æˆè®© student æ¨¡å‹å­¦ä¹ åˆ°æ›´ä¸°å¯Œçš„ç±»ç©ºé—´ç»“æ„ä¿¡æ¯<br>
(æŸä¸ªæ ·æœ¬åœ¨å±äºç±»Açš„åŒæ—¶å¯¹ç±»Bä»ç„¶æœ‰ä¸€å®šæ¦‚ç‡ï¼Œone-hotå‘é‡ä»…æœ‰ç¡¬åˆ†ç±»è¾¹ç•Œ)ï¼Œ<br>
è€Œåœ¨æœ¬æ–‡ä¸­æ˜¯åˆ©ç”¨&quot;æ¦‚ç‡å‘é‡&quot;åœ¨è®­ç»ƒstudentæ¨¡å‹æ—¶èƒ½è®©æ¨¡å‹æ›´åŠ &quot;å¹³æ»‘&quot;</p>
</blockquote>
<p><strong>æœ¬æ–‡æ ¸å¿ƒæ€æƒ³ï¼š</strong> è’¸é¦é€šè¿‡æš´éœ²ç±»åˆ«ä¹‹é—´çš„ç›¸å¯¹ä¿¡æ¯å¹¶ä½¿æ¨¡å‹åœ¨è®­ç»ƒæ—¶æ‹Ÿåˆè¿™ç§å¹³æ»‘çš„æ¦‚ç‡åˆ†å¸ƒï¼Œ<br>
ä»è€Œèƒ½é™ä½ç½‘ç»œè¾“å‡ºå¯¹è¾“å…¥å˜åŒ–çš„æ•æ„Ÿæ€§ï¼ˆå³å‡å°ç”¨äºç”Ÿæˆå¯¹æŠ—æ ·æœ¬çš„æ¢¯åº¦å¹…åº¦ï¼‰ã€‚<br>
å› æ­¤æœ¬æ–‡é€šè¿‡åœ¨åŒä¸€æ¨¡å‹ç»“æ„å†…éƒ¨å›çŒï¼ˆre-useï¼‰ç”±æ¨¡å‹è‡ªèº«ç”Ÿæˆçš„æ¦‚ç‡å‘é‡æ¥æå‡æ¨¡å‹å¯¹æŠ—æ ·æœ¬çš„é²æ£’æ€§ã€‚<br>
ä¹Ÿå°±æ˜¯è¯´ï¼Œé¦–å…ˆç”¨å¸¸è§„æ–¹å¼è®­ç»ƒå‡ºä¸€ä¸ª DNNï¼ˆæ•™å¸ˆï¼‰ï¼Œåˆ©ç”¨è¯¥æ•™å¸ˆåœ¨è®­ç»ƒé›†ä¸Šç”Ÿæˆçš„é«˜æ¸© softmax æ¦‚ç‡å‘é‡ä½œä¸ºâ€œè½¯æ ‡ç­¾â€ï¼Œ<br>
ç„¶åç”¨è¿™äº›&quot;è½¯æ ‡ç­¾&quot;å»å†è®­ç»ƒï¼ˆæˆ–å¾®è°ƒï¼‰åŒä¸€ç»“æ„çš„å¦ä¸€ä¸ª DNNï¼ˆå­¦ç”Ÿï¼‰ï¼Œä½¿å…¶è·å¾—æ›´å¹³æ»‘ã€æ›´ä¸æ˜“è¢«å°æ‰°åŠ¨å½±å“çš„åˆ¤åˆ«å‡½æ•°ã€‚</p>
<p>ä½œè€…æå‡ºæ¨¡å‹çš„é˜²å¾¡åº”è¯¥æ»¡è¶³ï¼š</p>
<ul>
<li>
<p>é€‚ç”¨æ€§ï¼šé˜²å¾¡åº”èƒ½æŠµå¾¡é è¿‘è®­ç»ƒæ•°æ®æµå½¢çš„å¯¹æŠ—æ ·æœ¬ï¼Œå› ä¸ºé‚£äº›è¿œç¦»è®­ç»ƒé›†çš„â€œå¥‡æ€ªâ€æ ·æœ¬åœ¨å®é™…ä¸­å¾€å¾€å®¹æ˜“è¢«äººç±»æˆ–å¼‚å¸¸æ£€æµ‹æœºåˆ¶å‘ç°ã€‚</p>
</li>
<li>
<p>å¼€é”€ä½ï¼šé˜²å¾¡ä¸åº”è¦æ±‚ä¿®æ”¹ DNN æ¶æ„ï¼Œåº”åœ¨è®­ç»ƒæ—¶æœ‰ä½é¢å¤–å¼€é”€ï¼Œæµ‹è¯•é˜¶æ®µé›¶å¼€é”€ã€‚</p>
</li>
<li>
<p>ä¿æŒç²¾åº¦ï¼šé˜²å¾¡åº”ç»´æŒåŸå§‹ DNN åœ¨æ­£å¸¸è¾“å…¥ä¸Šçš„åˆ†ç±»æ€§èƒ½ã€‚</p>
</li>
</ul>
<p><strong>è®­ç»ƒæµç¨‹ï¼ˆè§ä¸‹å›¾ï¼‰ï¼š</strong></p>
<p>![ ](/assets/img/2016_IEEE_Distillation as a defense to adversarial perturbations against deep neural_fig1.png &quot;é˜²å¾¡è’¸é¦è®­ç»ƒè¿‡ç¨‹&quot;)</p>
<ol>
<li>
<p>è¾“å…¥ä¸ºä¸€ç»„æ ·æœ¬ ğ‘‹ åŠå…¶ç¡¬æ ‡ç­¾ ğ‘Œ(ğ‘‹)ï¼ˆå³ one-hot å‘é‡ï¼‰ã€‚</p>
</li>
<li>
<p>ç”¨æ¸©åº¦ä¸º ğ‘‡ çš„ softmax è¾“å‡ºå±‚è®­ç»ƒç¬¬ä¸€ä¸ª DNN ğ¹ ï¼Œå¾—åˆ°æ¦‚ç‡å‘é‡ ğ¹(ğ‘‹)ã€‚</p>
</li>
<li>
<p>æ„é€ æ–°çš„è®­ç»ƒé›† {(ğ‘‹ , ğ¹(ğ‘‹))} ï¼Œç”¨æ¦‚ç‡å‘é‡ä½œä¸ºâ€œè½¯æ ‡ç­¾â€ã€‚</p>
</li>
<li>
<p>ç”¨ç›¸åŒç»“æ„çš„ç¬¬äºŒä¸ª DNNï¼ˆå­¦ç”Ÿç½‘ç»œï¼‰åœ¨æ¸©åº¦ ğ‘‡ ä¸‹è®­ç»ƒï¼Œä½¿å…¶å­¦ä¹ åˆ°æ¦‚ç‡åˆ†å¸ƒã€‚</p>
</li>
<li>
<p>æµ‹è¯•æ—¶æ¸©åº¦ ğ‘‡ æ¢å¤ä¸º 1ï¼Œä»¥è·å¾—å¸¸è§„çš„æ¦‚ç‡è¾“å‡ºå’Œåˆ†ç±»ç»“æœ</p>
</li>
</ol>
<hr>
<h1 id="distilling-the-knowledge-in-a-neural-network-corr-2015" tabindex="-1"><a class="header-anchor" href="#distilling-the-knowledge-in-a-neural-network-corr-2015"><span><a href="https://arxiv.org/abs/1503.02531" target="_blank" rel="noopener noreferrer">Distilling the knowledge in a neural network [CoRR 2015]</a></span></a></h1>
<p><strong>MOTIVATIONï¼š</strong> ä¼ ç»Ÿå°æ¨¡å‹è®­ç»ƒæ—¶ä»…ä¾èµ–äºâ€œç¡¬æ ‡ç­¾â€ï¼ˆæ­£ç¡®ç­”æ¡ˆï¼‰ï¼Œå¯¼è‡´æ³›åŒ–èƒ½åŠ›ä¸è¶³ï¼Œæ— æ³•ç»§æ‰¿å¤§æ¨¡å‹æˆ–é›†æˆæ¨¡å‹çš„ç»†ç²’åº¦çŸ¥è¯†ã€‚<br>
å› æ­¤æœ¬æ–‡æå‡ºâ€œçŸ¥è¯†è’¸é¦ï¼ˆdistillationï¼‰â€æ–¹æ³•ï¼Œ<br>
é€šè¿‡è½¯åŒ–åçš„æ¦‚ç‡åˆ†å¸ƒï¼ˆsoft targetsï¼‰å°†å¤§æ¨¡å‹çš„çŸ¥è¯†è¿ç§»åˆ°å°æ¨¡å‹ä¸­ï¼Œ<br>
ä½¿å°æ¨¡å‹ä¸ä»…å­¦ä¹ åˆ°æ­£ç¡®ç­”æ¡ˆï¼Œè¿˜èƒ½å­¦ä¹ å¤§æ¨¡å‹åœ¨é”™è¯¯ç±»åˆ«ä¸Šçš„æ³›åŒ–å€¾å‘ã€‚</p>
<p>ä½œè€…è®¤ä¸ºå¤§æ¨¡å‹å‡ ä¹æ€»æ˜¯ä»¥æé«˜ç½®ä¿¡åº¦ç»™å‡ºæ­£ç¡®ç­”æ¡ˆï¼Œæ­¤æ—¶å¤§éƒ¨åˆ†æœ‰ç”¨ä¿¡æ¯è•´è—åœ¨é”™è¯¯ç±»åˆ«æ¦‚ç‡ä¹‹é—´çš„ç›¸å¯¹æ¯”ç‡ä¸­ã€‚<br>
ä¾‹å¦‚ï¼Œä¸€ä¸ªâ€œ2â€çš„æŸä¸ªç‰ˆæœ¬å¯èƒ½æœ‰ 10â»â¶ çš„æ¦‚ç‡æ˜¯â€œ3â€ï¼Œ10â»â¹ çš„æ¦‚ç‡æ˜¯â€œ7â€ï¼›è€Œå¦ä¸€ä¸ªâ€œ2â€å¯èƒ½æ°å¥½ç›¸åã€‚<br>
è¿™äº›å¾®å°æ¦‚ç‡çš„ç›¸å¯¹å…³ç³»æ­ç¤ºäº†æ•°æ®çš„ç›¸ä¼¼ç»“æ„ï¼ˆå³å“ªäº›â€œ2â€æ›´åƒâ€œ3â€ï¼Œå“ªäº›æ›´åƒâ€œ7â€ï¼‰ï¼Œä½†å®ƒä»¬åœ¨äº¤å‰ç†µæŸå¤±ä¸­å‡ ä¹æ²¡æœ‰å½±å“ã€‚</p>
<p>æ³¨æ„çš„æ˜¯ï¼šè½¯ç›®æ ‡äº§ç”Ÿçš„æ¢¯åº¦é‡çº§ä¼šéšç€ $1/ğ‘‡^2$ ç¼©æ”¾ï¼Œå› æ­¤åœ¨åŒæ—¶ä½¿ç”¨ç¡¬æ ‡ç­¾ï¼ˆhard targetsï¼‰å’Œè½¯æ ‡ç­¾æ—¶ï¼Œ<br>
éœ€è¦æŠŠè½¯ç›®æ ‡çš„æ¢¯åº¦å†ä¹˜ä»¥ $ğ‘‡^2$ ï¼Œä»¥ä¿è¯åœ¨è°ƒæ•´æ¸©åº¦å‚æ•°æ—¶ï¼Œä¸¤ç§ç›®æ ‡çš„ç›¸å¯¹è´¡çŒ®ä¸ä¼šè¢«ç ´åã€‚</p>
<hr>
<h1 id="the-limitations-of-deep-learning-in-adversarial-settings-ieee-2016" tabindex="-1"><a class="header-anchor" href="#the-limitations-of-deep-learning-in-adversarial-settings-ieee-2016"><span><a href="https://ieeexplore.ieee.org/abstract/document/7467366/" target="_blank" rel="noopener noreferrer">The limitations of deep learning in adversarial settings [IEEE 2016]</a></span></a></h1>
<hr>
<h1 id="_1-ieee-2016" tabindex="-1"><a class="header-anchor" href="#_1-ieee-2016"><span><a href="https://ieeexplore.ieee.org/abstract/document/7467366/" target="_blank" rel="noopener noreferrer">1 [IEEE 2016]</a></span></a></h1>
<hr>
<h1 id="thingk" tabindex="-1"><a class="header-anchor" href="#thingk"><span>THINGK:</span></a></h1>
<p>æ‰¾å‡ºè§†é¢‘é¢†åŸŸ/LLMé¢†åŸŸé‡Œé¢æ¨¡å‹çš„å…±æ€§ï¼Œæ ¹æ®å…±æ€§è®¾è®¡æ”»å‡»æ–¹å¼å¯ä»¥æé«˜å¯¹æŠ—æ”»å‡»æ ·æœ¬çš„&quot;æ³›åŒ–æ€§&quot;</p>
<p>å¯¹æŠ—æ€§è´¨çš„dialogï¼Œå¦‚ä½•è®©æé—®è€…æ‰¾å‡ºå›¾ç‰‡(è§†é¢‘)çš„&quot;ç›²ç‚¹&quot;æå‡ºå®Œå…¨è§£ä¸å‡ºæ¥çš„é—®é¢˜ï¼Ÿ / å›ç­”è€…å¦‚ä½•åŠ å¼ºè§†è§‰ä¿¡æ¯çš„æƒé‡æ›´å¥½çš„å›ç­”é—®é¢˜ï¼Ÿ</p>
</div></template>


