<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.24" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.94" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"10. Git工具-重写历史","image":[""],"datePublished":"2023-05-15T00:00:00.000Z","dateModified":"2025-09-30T15:22:49.000Z","author":[{"@type":"Person","name":"Mr.R","url":"https://github.com/WillebrordSnell"}]}</script><meta property="og:url" content="https://mister-hope.github.io/Tools/Git/02DocumentNotes/documentnotes10.html"><meta property="og:site_name" content=" "><meta property="og:title" content="10. Git工具-重写历史"><meta property="og:description" content="10. Git工具-重写历史 许多时候，在使用 Git 时，你可能想要修订提交历史。 Git 很棒的一点是它允许你在最后时刻做决定。 你可以在将暂存区内容提交前决定哪些文件进入提交，可以通过 git stash 来决定不与某些内容工作， 也可以重写已经发生的提交就像它们以另一种方式发生的一样。 这可能涉及改变提交的顺序，改变提交中的信息或修改文件，将提..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-09-30T15:22:49.000Z"><meta property="article:published_time" content="2023-05-15T00:00:00.000Z"><meta property="article:modified_time" content="2025-09-30T15:22:49.000Z"><title>10. Git工具-重写历史 |  </title><meta name="description" content="10. Git工具-重写历史 许多时候，在使用 Git 时，你可能想要修订提交历史。 Git 很棒的一点是它允许你在最后时刻做决定。 你可以在将暂存区内容提交前决定哪些文件进入提交，可以通过 git stash 来决定不与某些内容工作， 也可以重写已经发生的提交就像它们以另一种方式发生的一样。 这可能涉及改变提交的顺序，改变提交中的信息或修改文件，将提...">
    <link rel="stylesheet" href="/assets/css/styles.960032b2.css">
    <link rel="preload" href="/assets/js/runtime~app.5de5abb4.js" as="script"><link rel="preload" href="/assets/css/styles.960032b2.css" as="style"><link rel="preload" href="/assets/js/8223.c18393a1.js" as="script"><link rel="preload" href="/assets/js/app.2399bda6.js" as="script">
    <link rel="prefetch" href="/assets/js/keyan_adversarialExample_adversarial-example.html.88d20a0b.js" as="script"><link rel="prefetch" href="/assets/js/book_202311.html.a70b14bd.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_02DocumentNotes_documentnotes01.html.478b0ad4.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_01Manual_manual01.html.c246ea45.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_02DocumentNotes_documentnotes08.html.75283506.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_02DocumentNotes_documentnotes10.html.dd3badaf.js" as="script"><link rel="prefetch" href="/assets/js/9013.5755f739.js" as="script"><link rel="prefetch" href="/assets/js/book_202310.html.f767372e.js" as="script"><link rel="prefetch" href="/assets/js/keyan_unrestrictedAdversarialExamples_unrestricted-adversarial-examples.html.42d978de.js" as="script"><link rel="prefetch" href="/assets/js/keyan_dialog.html.af769ca2.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_02DocumentNotes_documentnotes09.html.895117fb.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_02DocumentNotes_documentnotes06.html.c2cb131d.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_01Manual_manual02.html.a405ee6d.js" as="script"><link rel="prefetch" href="/assets/js/keyan_videoRepresentation_videoRepresentation.html.df1b0a85.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_02DocumentNotes_documentnotes07.html.c4134cb1.js" as="script"><link rel="prefetch" href="/assets/js/keyan_videoUnderstanding_videoUnderstanding.html.17835429.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_02DocumentNotes_documentnotes11.html.39e352f4.js" as="script"><link rel="prefetch" href="/assets/js/keyan_video.html.a4ba946e.js" as="script"><link rel="prefetch" href="/assets/js/demo_markdown.html.5b676c76.js" as="script"><link rel="prefetch" href="/assets/js/book_202309.html.d78860fc.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_02DocumentNotes_documentnotes02.html.9e8695f2.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_02DocumentNotes_documentnotes03.html.a91f47e9.js" as="script"><link rel="prefetch" href="/assets/js/book_maoxuan.html.c243bf06.js" as="script"><link rel="prefetch" href="/assets/js/Tools_MarkDown_markdown01.html.1a02d2a1.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_02DocumentNotes_documentnotes04.html.45934fc5.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Resource_index.html.5a3d6f2e.js" as="script"><link rel="prefetch" href="/assets/js/keyan_videoDialog_videoDialog.html.333664b4.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_02DocumentNotes_documentnotes05.html.dfe449e9.js" as="script"><link rel="prefetch" href="/assets/js/keyan_contrastiveLearning_contrastiveLearning.html.bea4f122.js" as="script"><link rel="prefetch" href="/assets/js/train_DDP_DDP.html.621bdfdb.js" as="script"><link rel="prefetch" href="/assets/js/Tools_MarkDown_index.html.bd04f6c1.js" as="script"><link rel="prefetch" href="/assets/js/demo_page.html.b1b0407b.js" as="script"><link rel="prefetch" href="/assets/js/train_AVSD_AVSD.html.28680b8b.js" as="script"><link rel="prefetch" href="/assets/js/Tools_MarkDown_markdown02.html.5b6d4f31.js" as="script"><link rel="prefetch" href="/assets/js/train_trick_trick.html.6e48444a.js" as="script"><link rel="prefetch" href="/assets/js/demo_layout.html.1566dc74.js" as="script"><link rel="prefetch" href="/assets/js/demo_encrypt.html.63d0d72a.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_index.html.a447d4d3.js" as="script"><link rel="prefetch" href="/assets/js/index.html.4f665872.js" as="script"><link rel="prefetch" href="/assets/js/keyan_index.html.8fe85687.js" as="script"><link rel="prefetch" href="/assets/js/posts_tomato.html.a7866eca.js" as="script"><link rel="prefetch" href="/assets/js/posts_banana_2.html.7b52ff94.js" as="script"><link rel="prefetch" href="/assets/js/posts_apple_2.html.1947b68a.js" as="script"><link rel="prefetch" href="/assets/js/posts_banana_1.html.afa24a5f.js" as="script"><link rel="prefetch" href="/assets/js/posts_banana_3.html.9f95802c.js" as="script"><link rel="prefetch" href="/assets/js/posts_banana_4.html.77286569.js" as="script"><link rel="prefetch" href="/assets/js/posts_apple_4.html.d2dfd1e6.js" as="script"><link rel="prefetch" href="/assets/js/posts_apple_3.html.ac1608d4.js" as="script"><link rel="prefetch" href="/assets/js/posts_apple_1.html.fa1060ac.js" as="script"><link rel="prefetch" href="/assets/js/posts_cherry.html.0f08304a.js" as="script"><link rel="prefetch" href="/assets/js/demo_disable.html.b3580fd0.js" as="script"><link rel="prefetch" href="/assets/js/posts_dragonfruit.html.92b240d1.js" as="script"><link rel="prefetch" href="/assets/js/posts_strawberry.html.1332a082.js" as="script"><link rel="prefetch" href="/assets/js/intro.html.8f71b7b9.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_01Manual_manual03.html.f4208c31.js" as="script"><link rel="prefetch" href="/assets/js/life_game_DeathStranding.html.32ca7f38.js" as="script"><link rel="prefetch" href="/assets/js/life_game_Bloodborne.html.c10edfab.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_02DocumentNotes_index.html.4ca087be.js" as="script"><link rel="prefetch" href="/assets/js/Tools_Git_01Manual_index.html.a6848e06.js" as="script"><link rel="prefetch" href="/assets/js/demo_index.html.5fc53d07.js" as="script"><link rel="prefetch" href="/assets/js/tag_无限制对抗攻击样本_index.html.357be623.js" as="script"><link rel="prefetch" href="/assets/js/tag_去码头整点论文_index.html.967728a1.js" as="script"><link rel="prefetch" href="/assets/js/tag_对抗攻击样本_index.html.c257344c.js" as="script"><link rel="prefetch" href="/assets/js/category_使用指南_index.html.8b9c0b3a.js" as="script"><link rel="prefetch" href="/assets/js/tag_使用指南_index.html.c1535f24.js" as="script"><link rel="prefetch" href="/assets/js/tag_对比学习_index.html.7d613677.js" as="script"><link rel="prefetch" href="/assets/js/tag_炼丹技巧_index.html.0f7410f4.js" as="script"><link rel="prefetch" href="/assets/js/tag_经典论文_index.html.8ca47de8.js" as="script"><link rel="prefetch" href="/assets/js/tag_视频对话_index.html.c5494187.js" as="script"><link rel="prefetch" href="/assets/js/tag_视频理解_index.html.1ded2571.js" as="script"><link rel="prefetch" href="/assets/js/tag_资源整合_index.html.b4e4d30a.js" as="script"><link rel="prefetch" href="/assets/js/tag_页面配置_index.html.d002cd64.js" as="script"><link rel="prefetch" href="/assets/js/keyan_unrestrictedAdversarialExamples_index.html.bc9d2374.js" as="script"><link rel="prefetch" href="/assets/js/category_火龙果_index.html.9a3bda78.js" as="script"><link rel="prefetch" href="/assets/js/tag_分布式_index.html.c7072aaf.js" as="script"><link rel="prefetch" href="/assets/js/tag_弯曲的_index.html.08e3db6d.js" as="script"><link rel="prefetch" href="/assets/js/category_指南_index.html.955773ce.js" as="script"><link rel="prefetch" href="/assets/js/category_樱桃_index.html.c1e6ab6b.js" as="script"><link rel="prefetch" href="/assets/js/category_水果_index.html.a5c7397e.js" as="script"><link rel="prefetch" href="/assets/js/category_游戏_index.html.9d5981db.js" as="script"><link rel="prefetch" href="/assets/js/category_炼丹_index.html.55031746.js" as="script"><link rel="prefetch" href="/assets/js/category_码头_index.html.c8392004.js" as="script"><link rel="prefetch" href="/assets/js/category_科研_index.html.323b1d2f.js" as="script"><link rel="prefetch" href="/assets/js/category_草莓_index.html.731000e4.js" as="script"><link rel="prefetch" href="/assets/js/category_蔬菜_index.html.74c92f00.js" as="script"><link rel="prefetch" href="/assets/js/category_苹果_index.html.2aca28a3.js" as="script"><link rel="prefetch" href="/assets/js/category_香蕉_index.html.7baa8110.js" as="script"><link rel="prefetch" href="/assets/js/category_markdown_index.html.ddfad450.js" as="script"><link rel="prefetch" href="/assets/js/tag_加密_index.html.7ef8ded4.js" as="script"><link rel="prefetch" href="/assets/js/tag_禁用_index.html.8917f7b8.js" as="script"><link rel="prefetch" href="/assets/js/tag_布局_index.html.f51bec97.js" as="script"><link rel="prefetch" href="/assets/js/tag_markdown_index.html.68a5d128.js" as="script"><link rel="prefetch" href="/assets/js/keyan_videoRepresentation_index.html.2338fa2c.js" as="script"><link rel="prefetch" href="/assets/js/keyan_contrastiveLearning_index.html.e6acb1be.js" as="script"><link rel="prefetch" href="/assets/js/keyan_adversarialExample_index.html.91cccdf5.js" as="script"><link rel="prefetch" href="/assets/js/keyan_videoUnderstanding_index.html.22dd8dfa.js" as="script"><link rel="prefetch" href="/assets/js/404.html.d65b79d4.js" as="script"><link rel="prefetch" href="/assets/js/category_炉_index.html.b1b3032f.js" as="script"><link rel="prefetch" href="/assets/js/tag_圆_index.html.6fa17e45.js" as="script"><link rel="prefetch" href="/assets/js/tag_大_index.html.fd8b207f.js" as="script"><link rel="prefetch" href="/assets/js/tag_红_index.html.f0eddaf5.js" as="script"><link rel="prefetch" href="/assets/js/tag_长_index.html.3ce238cf.js" as="script"><link rel="prefetch" href="/assets/js/category_git_index.html.8fbb34c4.js" as="script"><link rel="prefetch" href="/assets/js/tag_小_index.html.0252e2d1.js" as="script"><link rel="prefetch" href="/assets/js/tag_黄_index.html.ea447cfa.js" as="script"><link rel="prefetch" href="/assets/js/tag_ddp_index.html.854b29e8.js" as="script"><link rel="prefetch" href="/assets/js/tag_ps5_index.html.6fc15369.js" as="script"><link rel="prefetch" href="/assets/js/keyan_videoDialog_index.html.39b566a0.js" as="script"><link rel="prefetch" href="/assets/js/timeline_index.html.bf75e9b4.js" as="script"><link rel="prefetch" href="/assets/js/category_index.html.24b905cb.js" as="script"><link rel="prefetch" href="/assets/js/article_index.html.789c8f4d.js" as="script"><link rel="prefetch" href="/assets/js/tag_index.html.9d68f7c1.js" as="script"><link rel="prefetch" href="/assets/js/star_index.html.a2bda9f5.js" as="script"><link rel="prefetch" href="/assets/js/posts_banana_index.html.8cd7a397.js" as="script"><link rel="prefetch" href="/assets/js/train_trick_index.html.1d16b06c.js" as="script"><link rel="prefetch" href="/assets/js/posts_apple_index.html.da3bd338.js" as="script"><link rel="prefetch" href="/assets/js/train_AVSD_index.html.3967d20f.js" as="script"><link rel="prefetch" href="/assets/js/life_game_index.html.b42ad01e.js" as="script"><link rel="prefetch" href="/assets/js/posts_index.html.f4bd6e3f.js" as="script"><link rel="prefetch" href="/assets/js/train_DDP_index.html.55b6b5af.js" as="script"><link rel="prefetch" href="/assets/js/train_index.html.395863cb.js" as="script"><link rel="prefetch" href="/assets/js/Tools_index.html.0a5ad443.js" as="script"><link rel="prefetch" href="/assets/js/book_index.html.2299162c.js" as="script"><link rel="prefetch" href="/assets/js/life_index.html.c9b74d3d.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><!--[--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="带我回家"><img class="vp-nav-logo" src="https://theme-hope-assets.vuejs.press/logo.svg" alt><!----><span class="vp-site-name hide-in-pad"> </span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="🔧 工具"><!--[--><!---->🔧 工具<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">文档</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/Tools/MarkDown/" aria-label="Markdown"><!---->Markdown<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/Tools/Resource/" aria-label="资源整合"><!---->资源整合<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">工具</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link route-link-active auto-link" href="/Tools/Git/" aria-label="Git"><!---->Git<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="  📑 码头"><!--[--><!---->  📑 码头<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/keyan/videoUnderstanding/videoUnderstanding.html" aria-label="视频理解"><!---->视频理解<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/keyan/videoRepresentation/videoRepresentation.html" aria-label="视频表征"><!---->视频表征<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/keyan/videoDialog/videoDialog.html" aria-label="视频对话"><!---->视频对话<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/keyan/contrastiveLearning/contrastiveLearning.html" aria-label="对比学习"><!---->对比学习<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/keyan/adversarialExample/adversarial-example.html" aria-label="经典对抗攻击"><!---->经典对抗攻击<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/keyan/unrestrictedAdversarialExamples/unrestricted-adversarial-examples.html" aria-label="无限制对抗攻击"><!---->无限制对抗攻击<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="  🧫 炉"><!--[--><!---->  🧫 炉<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/train/DDP/DDP.html" aria-label="单机多卡DDP"><!---->单机多卡DDP<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/train/AVSD/AVSD.html" aria-label="AVSD"><!---->AVSD<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/train/trick/trick.html" aria-label="奇淫技巧"><!---->奇淫技巧<!----></a></li></ul></button></div></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!----><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/Tools/Git/" aria-label="Git"><!---->Git<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">1 手册</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">2 文档笔记</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/Tools/Git/02DocumentNotes/documentnotes01.html" aria-label="1. Git基础与命令"><!---->1. Git基础与命令<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Tools/Git/02DocumentNotes/documentnotes02.html" aria-label="2. Git分支-分支原理"><!---->2. Git分支-分支原理<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Tools/Git/02DocumentNotes/documentnotes03.html" aria-label="3. Git分支的新建与合并-分支操作"><!---->3. Git分支的新建与合并-分支操作<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Tools/Git/02DocumentNotes/documentnotes04.html" aria-label="4. Git分支管理-查看分支"><!---->4. Git分支管理-查看分支<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Tools/Git/02DocumentNotes/documentnotes05.html" aria-label="5. Git分支开发工作流"><!---->5. Git分支开发工作流<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Tools/Git/02DocumentNotes/documentnotes06.html" aria-label="6. Git分支-远程分支"><!---->6. Git分支-远程分支<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Tools/Git/02DocumentNotes/documentnotes07.html" aria-label="7. Git分支-变基"><!---->7. Git分支-变基<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Tools/Git/02DocumentNotes/documentnotes08.html" aria-label="8. Git工具-查看修订版本"><!---->8. Git工具-查看修订版本<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Tools/Git/02DocumentNotes/documentnotes09.html" aria-label="9. Git工具-交互式暂存"><!---->9. Git工具-交互式暂存<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/Tools/Git/02DocumentNotes/documentnotes10.html" aria-label="10. Git工具-重写历史"><!---->10. Git工具-重写历史<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Tools/Git/02DocumentNotes/documentnotes11.html" aria-label="11. Git工具-重置揭密"><!---->11. Git工具-重置揭密<!----></a></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->10. Git工具-重写历史</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/WillebrordSnell" target="_blank" rel="noopener noreferrer">Mr.R</a></span><span property="author" content="Mr.R"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2023/5/15</span><meta property="datePublished" content="2023-05-15T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 13 分钟</span><meta property="timeRequired" content="PT13M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color2 clickable" role="navigation">Git</span><!--]--><meta property="articleSection" content="Git"></span><!----></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1 id="_10-git工具-重写历史" tabindex="-1"><a class="header-anchor" href="#_10-git工具-重写历史"><span>10. Git工具-重写历史</span></a></h1><p>许多时候，在使用 Git 时，你可能想要修订提交历史。 Git 很棒的一点是它允许你在最后时刻做决定。 你可以在将暂存区内容提交前决定哪些文件进入提交，可以通过 <code>git stash</code> 来决定不与某些内容工作， 也可以重写已经发生的提交就像它们以另一种方式发生的一样。 这可能涉及改变提交的顺序，改变提交中的信息或修改文件，将提交压缩或是拆分， 或完全地移除提交——在将你的工作成果与他人共享之前。</p><p>在本节中，你可以学到如何完成这些工作，这样在与他人分享你的工作成果时你的提交历史将如你所愿地展示出来。</p><table><thead><tr><th>Note</th><th>在满意之前不要推送你的工作Git 的基本原则之一是，由于克隆中有很多工作是本地的，因此你可以 <strong>在本地</strong> 随便重写历史记录。 然而一旦推送了你的工作，那就完全是另一回事了，除非你有充分的理由进行更改，否则应该将推送的工作视为最终结果。 简而言之，在对它感到满意并准备与他人分享之前，应当避免推送你的工作。</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><h2 id="修改最后一次提交" tabindex="-1"><a class="header-anchor" href="#修改最后一次提交"><span>修改最后一次提交</span></a></h2><p>修改你最近一次提交可能是所有修改历史提交的操作中最常见的一个。 对于你的最近一次提交，你往往想做两件事情：简单地修改提交信息， 或者通过添加、移除或修改文件来更改提交实际的内容。</p><h3 id="修改提交信息" tabindex="-1"><a class="header-anchor" href="#修改提交信息"><span>修改提交信息</span></a></h3><p>如果，你只是想修改最近一次提交的提交信息，那么很简单：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> commit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --amend</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>上面这条命令会将最后一次的提交信息载入到编辑器中供你修改。 当保存并关闭编辑器后，编辑器会将更新后的提交信息写入新提交中，它会成为新的最后一次提交。</p><h3 id="修改实际内容" tabindex="-1"><a class="header-anchor" href="#修改实际内容"><span>修改实际内容</span></a></h3><p>另一方面，如果你想要修改最后一次提交的实际内容，那么流程很相似：首先作出你想要补上的修改， 暂存它们，然后用 <code>git commit --amend</code> 以新的改进后的提交来 <strong>替换</strong> 掉旧有的最后一次提交，</p><p>使用这个技巧的时候需要小心，因为修正会改变提交的 SHA-1 校验和。 它类似于一个小的变基——<strong>如果已经推送了最后一次提交就不要修正它</strong>。</p><table><thead><tr><th>Tip</th><th>修补后的提交可能需要修补提交信息当你在修补一次提交时，可以同时修改提交信息和提交内容。 如果你修补了提交的内容，那么几乎肯定要更新提交消息以反映修改后的内容。另一方面，如果你的修补是琐碎的（如修改了一个笔误或添加了一个忘记暂存的文件）， 那么之前的提交信息不必修改，你只需作出更改，暂存它们，然后通过以下命令避免不必要的编辑器环节即可：<code>$ git commit --amend --no-edit</code></th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><h2 id="修改多个提交信息" tabindex="-1"><a class="header-anchor" href="#修改多个提交信息"><span>修改多个提交信息</span></a></h2><p>为了修改在提交历史中较远的提交，必须使用更复杂的工具。 Git 没有一个改变历史工具，但是可以使用变基工具来变基一系列提交，基于它们原来的 HEAD 而不是将其移动到另一个新的上面。 通过交互式变基工具，可以在任何想要修改的提交后停止，然后修改信息、添加文件或做任何想做的事情。 可以通过给 <code>git rebase</code> 增加 <code>-i</code> 选项来交互式地运行变基。 必须指定想要重写多久远的历史，这可以通过告诉命令将要变基到的提交来做到。</p><p>例如，如果想要修改最近三次提交信息，或者那组提交中的任意一个提交信息， 将想要修改的最近一次提交的父提交作为参数传递给 <code>git rebase -i</code> 命令，即 <code>HEAD~2^</code> 或 <code>HEAD~3</code>。 记住 <code>~3</code> 可能比较容易，因为你正尝试修改最后三次提交；但是注意实际上指定了以前的四次提交，即想要修改提交的父提交：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rebase</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD~3</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>再次记住这是一个变基命令——在 <code>HEAD~3..HEAD</code> 范围内的每一个修改了提交信息的提交及其 <strong>所有后裔</strong> 都会被重写。 不要涉及任何已经推送到中央服务器的提交——这样做会产生一次变更的两个版本，因而使他人困惑。</p><p>运行这个命令会在文本编辑器上给你一个提交的列表，看起来像下面这样：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pick</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> f7f3f6d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> changed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> my</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bit</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pick</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 310154e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> updated</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> README</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> formatting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blame</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pick</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a5f4a0d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cat-file</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Rebase 710f0f8..a5f4a0d onto 710f0f8</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Commands:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># p, pick &lt;commit&gt; = use commit</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># r, reword &lt;commit&gt; = use commit, but edit the commit message</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># e, edit &lt;commit&gt; = use commit, but stop for amending</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># s, squash &lt;commit&gt; = use commit, but meld into previous commit</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># f, fixup &lt;commit&gt; = like &quot;squash&quot;, but discard this commit&#39;s log message</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># x, exec &lt;command&gt; = run command (the rest of the line) using shell</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># b, break = stop here (continue rebase later with &#39;git rebase --continue&#39;)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># d, drop &lt;commit&gt; = remove commit</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># l, label &lt;label&gt; = label current HEAD with a name</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># t, reset &lt;label&gt; = reset HEAD to a label</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># m, merge [-C &lt;commit&gt; | -c &lt;commit&gt;] &lt;label&gt; [# &lt;oneline&gt;]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># .       create a merge commit using the original merge commit&#39;s</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># .       message (or the oneline, if no original merge commit was</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># .       specified). Use -c &lt;commit&gt; to reword the commit message.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># These lines can be re-ordered; they are executed from top to bottom.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># If you remove a line here THAT COMMIT WILL BE LOST.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># However, if you remove everything, the rebase will be aborted.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Note that empty commits are commented out</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>需要重点注意的是相对于正常使用的 <code>log</code> 命令，这些提交显示的顺序是相反的。 运行一次 <em>log</em> 命令，会看到类似这样的东西：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --pretty=format:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;%h %s&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD~3..HEAD</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">a5f4a0d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cat-file</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">310154e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> updated</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> README</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> formatting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blame</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">f7f3f6d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> changed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> my</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bit</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意其中的反序显示。 交互式变基给你一个它将会运行的脚本。 它将会从你在命令行中指定的提交（<code>HEAD~3</code>）开始，从上到下的依次重演每一个提交引入的修改。 它将最旧的而不是最新的列在上面，因为那会是第一个将要重演的。</p><p>你需要修改脚本来让它停留在你想修改的变更上。 要达到这个目的，你只要将你想修改的每一次提交前面的 ‘pick’ 改为 ‘edit’。 例如，只想修改第三次提交信息，可以像下面这样修改文件：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">edit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> f7f3f6d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> changed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> my</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bit</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pick</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 310154e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> updated</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> README</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> formatting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blame</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pick</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a5f4a0d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cat-file</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当保存并退出编辑器时，Git 将你带回到列表中的最后一次提交，把你送回命令行并提示以下信息：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rebase</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD~3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Stopped</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> f7f3f6d...</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> changed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> my</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bit</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">You</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> can</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> amend</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> commit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> now,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> with</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">       git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> commit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --amend</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Once</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> you&#39;re satisfied with your changes, run</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       git rebase --continue</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这些指令准确地告诉你该做什么。 输入</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> commit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --amend</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>修改提交信息，然后退出编辑器。 然后，运行</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rebase</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --continue</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这个命令将会自动地应用另外两个提交，然后就完成了。 如果需要将不止一处的 pick 改为 edit，需要在每一个修改为 edit 的提交上重复这些步骤。 每一次，Git 将会停止，让你修正提交，然后继续直到完成。</p><h2 id="重新排序提交" tabindex="-1"><a class="header-anchor" href="#重新排序提交"><span>重新排序提交</span></a></h2><p>也可以使用交互式变基来重新排序或完全移除提交。 如果想要移除 “added cat-file” 提交然后修改另外两个提交引入的顺序，可以将变基脚本从这样：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pick</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> f7f3f6d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> changed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> my</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bit</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pick</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 310154e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> updated</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> README</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> formatting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blame</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pick</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a5f4a0d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cat-file</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>改为这样：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pick</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 310154e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> updated</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> README</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> formatting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blame</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pick</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> f7f3f6d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> changed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> my</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bit</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>当保存并退出编辑器时，Git 将你的分支带回这些提交的父提交，应用 <code>310154e</code> 然后应用 <code>f7f3f6d</code>，最后停止。 事实修改了那些提交的顺序并完全地移除了 “added cat-file” 提交。</p><h2 id="压缩提交" tabindex="-1"><a class="header-anchor" href="#压缩提交"><span>压缩提交</span></a></h2><p>通过交互式变基工具，也可以将一连串提交压缩成一个单独的提交。 在变基信息中脚本给出了有用的指令：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Commands:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># p, pick &lt;commit&gt; = use commit</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># r, reword &lt;commit&gt; = use commit, but edit the commit message</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># e, edit &lt;commit&gt; = use commit, but stop for amending</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># s, squash &lt;commit&gt; = use commit, but meld into previous commit</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># f, fixup &lt;commit&gt; = like &quot;squash&quot;, but discard this commit&#39;s log message</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># x, exec &lt;command&gt; = run command (the rest of the line) using shell</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># b, break = stop here (continue rebase later with &#39;git rebase --continue&#39;)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># d, drop &lt;commit&gt; = remove commit</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># l, label &lt;label&gt; = label current HEAD with a name</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># t, reset &lt;label&gt; = reset HEAD to a label</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># m, merge [-C &lt;commit&gt; | -c &lt;commit&gt;] &lt;label&gt; [# &lt;oneline&gt;]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># .       create a merge commit using the original merge commit&#39;s</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># .       message (or the oneline, if no original merge commit was</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># .       specified). Use -c &lt;commit&gt; to reword the commit message.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># These lines can be re-ordered; they are executed from top to bottom.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># If you remove a line here THAT COMMIT WILL BE LOST.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># However, if you remove everything, the rebase will be aborted.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Note that empty commits are commented out</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果，指定 “squash” 而不是 “pick” 或 “edit”，Git 将应用两者的修改并合并提交信息在一起。 所以，如果想要这三次提交变为一个提交，可以这样修改脚本：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pick</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> f7f3f6d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> changed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> my</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bit</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">squash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 310154e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> updated</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> README</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> formatting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blame</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">squash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a5f4a0d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cat-file</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当保存并退出编辑器时，Git 应用所有的三次修改然后将你放到编辑器中来合并三次提交信息：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># This is a combination of 3 commits.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># The first commit&#39;s message is:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">changed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> my</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># This is the 2nd commit message:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">updated</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> README</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> formatting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blame</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># This is the 3rd commit message:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cat-file</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当你保存之后，你就拥有了一个包含前三次提交的全部变更的提交。</p><h2 id="拆分提交" tabindex="-1"><a class="header-anchor" href="#拆分提交"><span>拆分提交</span></a></h2><p>拆分一个提交会撤消这个提交，然后多次地部分地暂存与提交直到完成你所需次数的提交。 例如，假设想要拆分三次提交的中间那次提交。 想要将它拆分为两次提交：第一个 “updated README formatting”，第二个 “added blame” 来代替原来的 “updated README formatting and added blame”。 可以通过修改 <code>rebase -i</code> 的脚本来做到这点，将要拆分的提交的指令修改为 “edit”：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pick</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> f7f3f6d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> changed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> my</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bit</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">edit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 310154e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> updated</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> README</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> formatting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blame</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pick</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a5f4a0d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cat-file</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后，当脚本带你进入到命令行时，重置那个提交，拿到被重置的修改，从中创建几次提交。 当保存并退出编辑器时，Git 带你到列表中第一个提交的父提交，应用第一个提交（<code>f7f3f6d</code>）， 应用第二个提交（<code>310154e</code>），然后让你进入命令行。 那里，可以通过 <code>git reset HEAD^</code> 做一次针对那个提交的混合重置，实际上将会撤消那次提交并将修改的文件取消暂存。 现在可以暂存并提交文件直到有几个提交，然后当完成时运行 <code>git rebase --continue</code>：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reset</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD^</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> README</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> commit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;updated README formatting&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lib/simplegit.rb</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> commit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;added blame&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rebase</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --continue</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Git 在脚本中应用最后一次提交（<code>a5f4a0d</code>），历史记录看起来像这样：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --pretty=format:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;%h %s&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1c002dd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cat-file</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">9b29157</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> added</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blame</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">35cfb2b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> updated</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> README</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> formatting</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">f3cc40e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> changed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> my</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bit</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>再次强调，这些改动了所有在列表中的提交的 SHA-1 校验和，所以要确保列表中的提交还没有推送到共享仓库中。</p><h2 id="核武器级选项-filter-branch" tabindex="-1"><a class="header-anchor" href="#核武器级选项-filter-branch"><span>核武器级选项：filter-branch</span></a></h2><p>有另一个历史改写的选项，如果想要通过脚本的方式改写大量提交的话可以使用它——例如，全局修改你的邮箱地址或从每一个提交中移除一个文件。 这个命令是 <code>filter-branch</code>，它可以改写历史中大量的提交，除非你的项目还没有公开并且其他人没有基于要改写的工作的提交做的工作，否则你不应当使用它。 然而，它可以很有用。 你将会学习到几个常用的用途，这样就得到了它适合使用地方的想法。</p><table><thead><tr><th>Caution</th><th><code>git filter-branch</code> 有很多陷阱，不再推荐使用它来重写历史。 请考虑使用 <code>git-filter-repo</code>，它是一个 Python 脚本，相比大多数使用 <code>filter-branch</code> 的应用来说，它做得要更好。它的文档和源码可访问 <a href="https://github.com/newren/git-filter-repo" target="_blank" rel="noopener noreferrer">https://github.com/newren/git-filter-repo</a> 获取。</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><h3 id="从每一个提交中移除一个文件" tabindex="-1"><a class="header-anchor" href="#从每一个提交中移除一个文件"><span>从每一个提交中移除一个文件</span></a></h3><p>这经常发生。 有人粗心地通过 <code>git add .</code> 提交了一个巨大的二进制文件，你想要从所有地方删除。 可能偶然地提交了一个包括一个密码的文件，然而你想要开源项目。 <code>filter-branch</code> 是一个可能会用来擦洗整个提交历史的工具。 为了从整个提交历史中移除一个叫做 <code>passwords.txt</code> 的文件，可以使用 <code>--tree-filter</code> 选项给 <code>filter-branch</code>：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filter-branch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --tree-filter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;rm -f passwords.txt&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Rewrite</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 6b9b3cf04e7c5686a9cb838c3f36a8cb6a0fc2bd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (21/21)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Ref</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;refs/heads/master&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> was</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rewritten</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>--tree-filter</code> 选项在检出项目的每一个提交后运行指定的命令然后重新提交结果。 在本例中，你从每一个快照中移除了一个叫作 <code>passwords.txt</code> 的文件，无论它是否存在。 如果想要移除所有偶然提交的编辑器备份文件，可以运行类似 <code>git filter-branch --tree-filter &#39;rm -f *~&#39; HEAD</code> 的命令。</p><p>最后将可以看到 Git 重写树与提交然后移动分支指针。 通常一个好的想法是在一个测试分支中做这件事，然后当你决定最终结果是真正想要的，可以硬重置 <code>master</code> 分支。 为了让 <code>filter-branch</code> 在所有分支上运行，可以给命令传递 <code>--all</code> 选项。</p><h3 id="使一个子目录做为新的根目录" tabindex="-1"><a class="header-anchor" href="#使一个子目录做为新的根目录"><span>使一个子目录做为新的根目录</span></a></h3><p>假设已经从另一个源代码控制系统中导入，并且有几个没意义的子目录（<code>trunk</code>、<code>tags</code> 等等）。 如果想要让 <code>trunk</code> 子目录作为每一个提交的新的项目根目录，<code>filter-branch</code> 也可以帮助你那么做：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filter-branch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --subdirectory-filter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> trunk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Rewrite</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 856f0bf61e41a27326cdae8f09fe708d679f596f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (12/12)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Ref</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;refs/heads/master&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> was</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rewritten</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>现在新项目根目录是 <code>trunk</code> 子目录了。 Git 会自动移除所有不影响子目录的提交。</p><h3 id="全局修改邮箱地址" tabindex="-1"><a class="header-anchor" href="#全局修改邮箱地址"><span>全局修改邮箱地址</span></a></h3><p>另一个常见的情形是在你开始工作时忘记运行 <code>git config</code> 来设置你的名字与邮箱地址， 或者你想要开源一个项目并且修改所有你的工作邮箱地址为你的个人邮箱地址。 任何情形下，你也可以通过 <code>filter-branch</code> 来一次性修改多个提交中的邮箱地址。 需要小心的是只修改你自己的邮箱地址，所以你使用 <code>--commit-filter</code>：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filter-branch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --commit-filter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        if [ &quot;$GIT_AUTHOR_EMAIL&quot; = &quot;schacon@localhost&quot; ];</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                GIT_AUTHOR_NAME=&quot;Scott Chacon&quot;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                GIT_AUTHOR_EMAIL=&quot;schacon@example.com&quot;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                git commit-tree &quot;$@&quot;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        else</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                git commit-tree &quot;$@&quot;;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        fi&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这会遍历并重写每一个提交来包含你的新邮箱地址。 因为提交包含了它们父提交的 SHA-1 校验和，这个命令会修改你的历史中的每一个提交的 SHA-1 校验和， 而不仅仅只是那些匹配邮箱地址的提交。</p></div><!----><!----><!----></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">最近更新</span><time class="vp-meta-info" datetime="2025-09-30T15:22:49.000Z" data-allow-mismatch>2025/9/30 15:22</time></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 799976781@qq.com">R</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/Tools/Git/02DocumentNotes/documentnotes09.html" aria-label="9. Git工具-交互式暂存"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->9. Git工具-交互式暂存</div></a><a class="route-link auto-link next" href="/Tools/Git/02DocumentNotes/documentnotes11.html" aria-label="11. Git工具-重置揭密"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">11. Git工具-重置揭密<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">西湖美景, 三月天嘞~</div><div class="vp-copyright">Copyright © 2025 Mr.R </div></footer></div><!--]--><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.5de5abb4.js" defer></script><script src="/assets/js/8223.c18393a1.js" defer></script><script src="/assets/js/app.2399bda6.js" defer></script>
  </body>
</html>
